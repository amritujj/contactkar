<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vehicle Tags - ContactKar</title>
  <link rel="stylesheet" href="styles_v2.css"/>
  <link rel="stylesheet" href="globalanimations.css"/>
  <style>
    .scroll-anim { opacity: 0; transform: translateY(24px); transition: opacity .6s ease, transform .6s ease; }
    .scroll-anim.visible { opacity: 1; transform: translateY(0); }
    .steps-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; padding: 2rem 0; }
    .step-card { background: white; border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center; }
    .step-num { background: var(--primary); color: white; width: 36px; height: 36px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 800; margin-bottom: .8rem; }
    .test-badge { background: #fef3c7; color: #92400e; border: 1px solid #fcd34d; border-radius: 6px; padding: 3px 10px; font-size: 11px; font-weight: 700; display: inline-block; margin-bottom: 6px; }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="container">
    <a href="index.html" class="nav-brand">Contact<span>Kar</span></a>
    <ul class="nav-menu">
      <li><a href="index.html" class="nav-link">Home</a></li>
      <li><a href="vehicle.html" class="nav-link active">Vehicle Tags</a></li>
      <li><a href="pet.html" class="nav-link">Pet Tags</a></li>
    </ul>
    <div>
      <a href="login.html" id="loginBtn" class="btn-nav btn-login">Login / Sign Up</a>
      <a href="dashboard.html" id="accountBtn" class="btn-nav btn-account">My Account</a>
    </div>
  </div>
</nav>

<header class="hero anim-fade-down" style="background:#eff6ff;">
  <div class="container">
    <div class="hero-icon" style="font-size:3.5rem;margin-bottom:1rem;">ðŸš—</div>
    <h1 style="color:var(--primary-dark);">Never Get Stuck in Parking Again</h1>
    <p>Smart QR Tags + Number Plate Search for your Car, Bike, or Truck.</p>
    <a href="#pricing" class="btn btn-primary">See Plans</a>
  </div>
</header>

<!-- How it works -->
<section class="container" style="padding:3rem 0;">
  <h2 style="text-align:center;margin-bottom:.5rem;">How It Works</h2>
  <p style="text-align:center;color:var(--text-light);margin-bottom:1rem;">Simple 3-step process.</p>
  <div class="steps-grid">
    <div class="step-card scroll-anim">
      <div class="step-num">1</div>
      <h3>Stick the QR</h3>
      <p style="font-size:.9rem;color:var(--text-light);">Place the sticker on your windshield or bumper.</p>
    </div>
    <div class="step-card scroll-anim">
      <div class="step-num">2</div>
      <h3>Someone Scans</h3>
      <p style="font-size:.9rem;color:var(--text-light);">Finder scans the QR or types your plate number.</p>
    </div>
    <div class="step-card scroll-anim">
      <div class="step-num">3</div>
      <h3>You Get Notified</h3>
      <p style="font-size:.9rem;color:var(--text-light);">Receive a private call/WhatsApp â€” number never revealed.</p>
    </div>
  </div>
</section>

<!-- Pricing -->
<section id="pricing" class="container" style="padding:2rem 0 4rem;">
  <h2 style="text-align:center;margin-bottom:.4rem;">Choose Your Plan</h2>
  <p style="text-align:center;color:var(--text-light);margin-bottom:.5rem;">All plans are FREE during testing mode.</p>
  <div class="pricing-grid">

    <div class="tier-card scroll-anim">
      <h3>Basic</h3>
      <p style="color:#666;font-size:13px;">Essential privacy for 1 vehicle.</p>
      <div class="price"><span class="strike-price">â‚¹99</span>â‚¹0<span>/year</span></div>
      <div class="test-badge">ðŸ§ª TESTING â€” FREE</div>
      <ul class="feature-list">
        <li>1 Vehicle Tag</li>
        <li>QR Sticker (Soft Copy)</li>
        <li>Voice Call Alerts</li>
        <li>1 Emergency Contact</li>
      </ul>
      <button class="btn-buy" onclick="checkout('basic')">Get Basic Free</button>
    </div>

    <div class="tier-card popular scroll-anim">
      <div class="popular-badge">MOST POPULAR</div>
      <h3>Plus</h3>
      <p style="color:#666;font-size:13px;">Best for couples or 2 vehicles.</p>
      <div class="price"><span class="strike-price">â‚¹249</span>â‚¹0<span>/year</span></div>
      <div class="test-badge">ðŸ§ª TESTING â€” FREE</div>
      <ul class="feature-list">
        <li>Up to 3 Tags</li>
        <li>WhatsApp & SMS Alerts</li>
        <li>2 Emergency Contacts</li>
        <li>Custom Scan Page Colors</li>
      </ul>
      <button class="btn-buy" onclick="checkout('plus')">Get Plus Free</button>
    </div>

    <div class="tier-card scroll-anim">
      <h3>Pro</h3>
      <p style="color:#666;font-size:13px;">Maximum security for families.</p>
      <div class="price"><span class="strike-price">â‚¹499</span>â‚¹0<span>/year</span></div>
      <div class="test-badge">ðŸ§ª TESTING â€” FREE</div>
      <ul class="feature-list">
        <li>Up to 5 Tags</li>
        <li>Video Call Alerts</li>
        <li>3 Emergency Contacts</li>
        <li>Priority WhatsApp Support</li>
      </ul>
      <button class="btn-buy" onclick="checkout('pro')">Get Pro Free</button>
    </div>
  </div>
</section>

<footer>
  <div class="container">
    <div class="footer-content">
      <div class="footer-col"><h3>ContactKar</h3><p>Connecting people, protecting privacy.</p></div>
      <div class="footer-col"><h3>Products</h3><a href="vehicle.html">Vehicle Tags</a><a href="pet.html">Pet Tags</a></div>
      <div class="footer-col"><h3>Account</h3><a href="login.html">Login</a><a href="dashboard.html">Dashboard</a></div>
    </div>
    <div class="footer-bottom">Â© 2026 ContactKar. All rights reserved.</div>
  </div>
</footer>

<script src="nav_logic.js"></script>
<script src="animations.js"></script>
<script>
const API_URL = 'https://contactkar.onrender.com/api';

// How many vehicle tags each tier gives
const TIER_TAG_COUNT = { basic: 1, plus: 3, pro: 5 };

async function checkout(tier) {
  const token = localStorage.getItem('token');
  if (!token) { alert('Please login first!'); window.location.href = 'login.html'; return; }
  const btn = event.target;
  btn.textContent = 'Processing...'; btn.disabled = true;

  try {
    // Step 1: Upgrade billing tier
    const upgradeRes  = await fetch(API_URL + '/billing/upgrade', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', Authorization: 'Bearer ' + token },
      body: JSON.stringify({ tier })
    });
    const upgradeData = await upgradeRes.json();
    if (!upgradeData.success) {
      alert('Error: ' + upgradeData.error);
      btn.textContent = 'Try Again'; btn.disabled = false;
      return;
    }

    // Step 2: Create the actual tag(s) in the database
    const tagCount = TIER_TAG_COUNT[tier] || 1;
    const orderRes  = await fetch(API_URL + '/orders/place', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', Authorization: 'Bearer ' + token },
      body: JSON.stringify({
        vehicleQty: tagCount,
        petQty: 0,
        address: 'Soft Copy',
        city: 'N/A',
        state: 'N/A',
        pincode: '000000'
      })
    });
    const orderData = await orderRes.json();
    if (orderData.success || orderData.orderId) {
      alert('âœ… You are now on the ' + tier.toUpperCase() + ' plan! Your ' + tagCount + ' vehicle tag(s) are ready in your dashboard.');
      window.location.href = 'dashboard.html';
    } else {
      alert('Plan activated but tag creation failed: ' + (orderData.error || 'Try refreshing dashboard.'));
      window.location.href = 'dashboard.html';
    }
  } catch(e) {
    alert('Server error. Render may be starting up â€” try again in 30s.');
    btn.textContent = 'Get ' + tier; btn.disabled = false;
  }
}
</script>
</body>
</html>
