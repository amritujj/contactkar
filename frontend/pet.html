<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pet Tags - ContactKar</title>
  <link rel="stylesheet" href="styles_v2.css"/>
  <link rel="stylesheet" href="globalanimations.css"/>
  <style>
    .scroll-anim { opacity:0; transform:translateY(24px); transition:opacity .6s ease,transform .6s ease; }
    .scroll-anim.visible { opacity:1; transform:translateY(0); }
    .pet-hero { background:linear-gradient(135deg,#fdf2f8 0%,#fce7f3 100%); }
    .pet-tier-card { border:2px solid var(--border); border-radius:14px; padding:2rem; text-align:center; background:white; transition:.3s; position:relative; }
    .pet-tier-card:hover { border-color:var(--pet-color); transform:translateY(-6px); box-shadow:0 14px 32px rgba(236,72,153,.14); }
    .pet-tier-card.popular { border-color:var(--pet-color); }
    .pet-badge { background:var(--pet-color); color:white; padding:4px 14px; border-radius:20px; font-size:12px; font-weight:700; position:absolute; top:-13px; left:50%; transform:translateX(-50%); }
    .test-badge { background:#fef3c7; color:#92400e; border:1px solid #fcd34d; border-radius:6px; padding:3px 10px; font-size:11px; font-weight:700; display:inline-block; margin-bottom:6px; }
    .btn-buy-pet { background:var(--pet-color); color:white; border:none; padding:.75rem 1.5rem; border-radius:8px; width:100%; font-size:.95rem; font-weight:700; cursor:pointer; transition:.2s; font-family:inherit; }
    .btn-buy-pet:hover { background:var(--pet-dark); }
    .steps-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1.5rem; padding:2rem 0; }
    .step-card { background:white; border-radius:12px; padding:1.5rem; border:1px solid var(--border); text-align:center; }
    .step-num-pet { background:var(--pet-color); color:white; width:36px; height:36px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-weight:800; margin-bottom:.8rem; }
    /* Checkout Modal */
    .ck-overlay { position:fixed; inset:0; background:rgba(0,0,0,.55); z-index:9999; display:flex; align-items:center; justify-content:center; padding:1rem; }
    .ck-modal { background:#fff; border-radius:18px; padding:2rem; max-width:480px; width:100%; box-shadow:0 20px 60px rgba(0,0,0,.25); max-height:90vh; overflow-y:auto; }
    .ck-modal h2 { font-size:1.2rem; font-weight:900; margin-bottom:.3rem; color:#111827; }
    .ck-modal .modal-sub { font-size:.85rem; color:#6b7280; margin-bottom:1.4rem; }
    .ck-modal .fg { margin-bottom:1rem; }
    .ck-modal .fg label { display:block; font-weight:700; font-size:.8rem; color:#374151; margin-bottom:.35rem; text-transform:uppercase; letter-spacing:.4px; }
    .ck-modal .fg input { width:100%; padding:.7rem 1rem; border:1.5px solid #d1d5db; border-radius:10px; font-size:.9rem; outline:none; font-family:inherit; transition:border-color .2s,box-shadow .2s; }
    .ck-modal .fg input:focus { border-color:#ec4899; box-shadow:0 0 0 3px rgba(236,72,153,.12); }
    .ck-modal .ec-section { background:#fdf2f8; border:1.5px solid #fbcfe8; border-radius:12px; padding:1rem; margin-bottom:1rem; }
    .ck-modal .ec-section h4 { font-size:.82rem; font-weight:800; color:#374151; text-transform:uppercase; letter-spacing:.4px; margin-bottom:.8rem; }
    .ck-modal .modal-actions { display:flex; gap:.6rem; margin-top:1.2rem; flex-wrap:wrap; }
    .ck-modal .btn-confirm-pet { flex:1; background:linear-gradient(135deg,#ec4899,#db2777); color:#fff; border:none; border-radius:10px; padding:.8rem 1.5rem; font-weight:800; font-size:.95rem; cursor:pointer; font-family:inherit; transition:.2s; }
    .ck-modal .btn-confirm-pet:hover { transform:translateY(-1px); box-shadow:0 6px 18px rgba(236,72,153,.35); }
    .ck-modal .btn-confirm-pet:disabled { opacity:.6; cursor:not-allowed; transform:none; }
    .ck-modal .btn-cancel { background:#fff; color:#374151; border:1.5px solid #d1d5db; border-radius:10px; padding:.8rem 1.2rem; font-weight:700; font-size:.9rem; cursor:pointer; font-family:inherit; transition:.2s; }
    .ck-modal .btn-cancel:hover { background:#f9fafb; }
    .plan-badge-pet { display:inline-block; background:#fce7f3; color:#be185d; border-radius:20px; padding:3px 12px; font-size:.78rem; font-weight:800; margin-bottom:.6rem; }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="container">
    <a href="index.html" class="nav-brand">Contact<span>Kar</span></a>
    <ul class="nav-menu">
      <li><a href="index.html" class="nav-link">Home</a></li>
      <li><a href="vehicle.html" class="nav-link">Vehicle Tags</a></li>
      <li><a href="pet.html" class="nav-link active">Pet Tags</a></li>
    </ul>
    <div>
      <a href="login.html" id="loginBtn" class="btn-nav btn-login">Login / Sign Up</a>
      <a href="dashboard.html" id="accountBtn" class="btn-nav btn-account">My Account</a>
    </div>
  </div>
</nav>

<header class="hero pet-hero anim-fade-down">
  <div class="container">
    <div style="font-size:3.5rem;margin-bottom:1rem;">&#128062;</div>
    <h1 style="color:var(--pet-dark);">Keep Your Pet Safe, Always</h1>
    <p>Smart QR Tags so anyone who finds your pet can reach you instantly &mdash; privately.</p>
    <a href="#pet-pricing" class="btn btn-pet">See Plans</a>
  </div>
</header>

<section class="container" style="padding:3rem 0;">
  <h2 style="text-align:center;margin-bottom:.5rem;">How It Works</h2>
  <p style="text-align:center;color:var(--text-light);margin-bottom:1rem;">Simple 3-step process.</p>
  <div class="steps-grid">
    <div class="step-card scroll-anim"><div class="step-num-pet">1</div><h3>Attach the Tag</h3><p style="font-size:.9rem;color:var(--text-light);">Stick or clip the QR tag on your pet's collar.</p></div>
    <div class="step-card scroll-anim"><div class="step-num-pet">2</div><h3>Someone Scans</h3><p style="font-size:.9rem;color:var(--text-light);">Finder scans the QR with any phone camera.</p></div>
    <div class="step-card scroll-anim"><div class="step-num-pet">3</div><h3>You Get Called</h3><p style="font-size:.9rem;color:var(--text-light);">Receive a private call &mdash; your number stays hidden.</p></div>
  </div>
</section>

<section id="pet-pricing" class="container" style="padding:2rem 0 4rem;">
  <h2 style="text-align:center;margin-bottom:.4rem;">Choose Your Plan</h2>
  <p style="text-align:center;color:var(--text-light);margin-bottom:.5rem;">All plans are FREE during testing mode.</p>
  <div class="pricing-grid">
    <div class="pet-tier-card scroll-anim">
      <h3>Basic</h3><p style="color:#666;font-size:13px;">For 1 pet.</p>
      <div class="price"><span class="strike-price">&#8377;99</span>&#8377;0<span>/year</span></div>
      <div class="test-badge">&#129514; TESTING &mdash; FREE</div>
      <ul class="feature-list"><li>1 Pet Tag</li><li>QR (Soft Copy)</li><li>Voice Call Alerts</li><li>1 Emergency Contact</li></ul>
      <button class="btn-buy-pet" onclick="openCheckout('basic',1,1)">Get Basic Free</button>
    </div>
    <div class="pet-tier-card popular scroll-anim">
      <div class="pet-badge">MOST POPULAR</div>
      <h3>Plus</h3><p style="color:#666;font-size:13px;">For up to 3 pets.</p>
      <div class="price"><span class="strike-price">&#8377;249</span>&#8377;0<span>/year</span></div>
      <div class="test-badge">&#129514; TESTING &mdash; FREE</div>
      <ul class="feature-list"><li>Up to 3 Tags</li><li>WhatsApp &amp; SMS Alerts</li><li>2 Emergency Contacts</li><li>Custom Scan Page Colors</li></ul>
      <button class="btn-buy-pet" onclick="openCheckout('plus',3,2)">Get Plus Free</button>
    </div>
    <div class="pet-tier-card scroll-anim">
      <h3>Pro</h3><p style="color:#666;font-size:13px;">For families with multiple pets.</p>
      <div class="price"><span class="strike-price">&#8377;499</span>&#8377;0<span>/year</span></div>
      <div class="test-badge">&#129514; TESTING &mdash; FREE</div>
      <ul class="feature-list"><li>Up to 5 Tags</li><li>Video Call Alerts</li><li>3 Emergency Contacts</li><li>Priority WhatsApp Support</li></ul>
      <button class="btn-buy-pet" onclick="openCheckout('pro',5,3)">Get Pro Free</button>
    </div>
  </div>
</section>

<footer>
  <div class="container">
    <div class="footer-content">
      <div class="footer-col"><h3>ContactKar</h3><p>Connecting people, protecting privacy.</p></div>
      <div class="footer-col"><h3>Products</h3><a href="vehicle.html">Vehicle Tags</a><a href="pet.html">Pet Tags</a></div>
      <div class="footer-col"><h3>Account</h3><a href="login.html">Login</a><a href="dashboard.html">Dashboard</a></div>
    </div>
    <div class="footer-bottom">&copy; 2026 ContactKar. All rights reserved.</div>
  </div>
</footer>

<!-- Checkout Modal -->
<div id="checkout-modal" class="ck-overlay" style="display:none;">
  <div class="ck-modal">
    <span id="modal-plan-badge" class="plan-badge-pet">BASIC PLAN</span>
    <h2 id="modal-title">Set Up Your Pet Tags</h2>
    <p class="modal-sub" id="modal-sub">Fill in your details to activate your tags.</p>
    <div class="fg"><label>Your Full Name *</label><input type="text" id="m-name" placeholder="e.g. Amrit Ujjwal"/></div>
    <div class="fg"><label>Your Phone Number *</label><input type="tel" id="m-phone" placeholder="10-digit mobile number" maxlength="10"/></div>
    <div class="fg"><label>Pet Name (optional)</label><input type="text" id="m-petname" placeholder="e.g. Bruno, Simba"/></div>
    <div class="fg"><label>Pet Breed (optional)</label><input type="text" id="m-breed" placeholder="e.g. Labrador, Persian Cat"/></div>
    <div class="ec-section">
      <h4 id="ec-heading">Emergency Contacts</h4>
      <div id="ec-fields"></div>
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeCheckout()">Cancel</button>
      <button class="btn-confirm-pet" id="confirm-btn" onclick="submitCheckout()">&#9989; Activate Tags</button>
    </div>
  </div>
</div>

<script src="nav_logic.js"></script>
<script>
const API_URL = 'https://contactkar.onrender.com/api';
var _tier = '', _tagCount = 1, _ecCount = 1;

function openCheckout(tier, tagCount, ecCount) {
  if (!localStorage.getItem('token')) { alert('Please login first!'); window.location.href = 'login.html'; return; }
  _tier = tier; _tagCount = tagCount; _ecCount = ecCount;
  document.getElementById('modal-plan-badge').textContent = tier.toUpperCase() + ' PLAN';
  document.getElementById('modal-title').textContent = 'Set Up Your ' + tier.charAt(0).toUpperCase() + tier.slice(1) + ' Pet Tags';
  document.getElementById('modal-sub').textContent = tagCount + ' pet tag(s) \u2022 ' + ecCount + ' emergency contact(s)';
  var ecHtml = '';
  for (var i = 1; i <= ecCount; i++) {
    ecHtml += '<div class="fg"><label>Emergency Contact ' + (ecCount > 1 ? i + ' ' : '') + '(Phone Number) *</label>' +
              '<input type="tel" id="ec-' + i + '" placeholder="10-digit mobile number" maxlength="10"/></div>';
  }
  document.getElementById('ec-fields').innerHTML = ecHtml;
  document.getElementById('ec-heading').textContent = '\uD83D\uDEA8 Emergency Contact' + (ecCount > 1 ? 's (' + ecCount + ')' : '');
  document.getElementById('checkout-modal').style.display = 'flex';
  document.getElementById('m-name').focus();
}

function closeCheckout() {
  document.getElementById('checkout-modal').style.display = 'none';
  var btn = document.getElementById('confirm-btn');
  btn.textContent = '\u2705 Activate Tags'; btn.disabled = false;
}

async function submitCheckout() {
  var token   = localStorage.getItem('token');
  var name    = document.getElementById('m-name').value.trim();
  var phone   = document.getElementById('m-phone').value.trim();
  var petname = document.getElementById('m-petname').value.trim();
  var breed   = document.getElementById('m-breed').value.trim();
  if (!name) { alert('Please enter your full name.'); return; }
  if (!phone || phone.length !== 10 || isNaN(phone)) { alert('Please enter a valid 10-digit phone number.'); return; }
  var ecNums = [];
  for (var i = 1; i <= _ecCount; i++) {
    var ec = document.getElementById('ec-' + i).value.trim();
    if (!ec || ec.length !== 10 || isNaN(ec)) { alert('Please enter a valid 10-digit number for Emergency Contact ' + i + '.'); return; }
    ecNums.push(ec);
  }
  var btn = document.getElementById('confirm-btn');
  btn.textContent = 'Processing...'; btn.disabled = true;
  try {
    var upRes  = await fetch(API_URL + '/billing/upgrade', {
      method:'POST', headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},
      body: JSON.stringify({ tier: _tier })
    });
    var upData = await upRes.json();
    if (!upData.success) { alert('Error: ' + upData.error); btn.textContent='\u2705 Activate Tags'; btn.disabled=false; return; }
    var orderRes = await fetch(API_URL + '/orders/place', {
      method:'POST', headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},
      body: JSON.stringify({ vehicleQty:0, petQty:_tagCount, address:'Soft Copy', city:'N/A', state:'N/A', pincode:'000000',
        ownername:name, ownerphone:phone, petname:petname||null, petbreed:breed||null, emergency:ecNums.join(', ') })
    });
    var orderData = await orderRes.json();
    closeCheckout();
    alert('\u2705 ' + _tier.toUpperCase() + ' plan activated! Your ' + _tagCount + ' pet tag(s) are ready in your dashboard.');
    window.location.href = 'dashboard.html';
  } catch(e) { alert('Server error. Try again in 30s.'); btn.textContent='\u2705 Activate Tags'; btn.disabled=false; }
}
document.getElementById('checkout-modal').addEventListener('click', function(e){ if(e.target===this) closeCheckout(); });
</script>
</body>
</html>